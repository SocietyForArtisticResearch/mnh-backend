<html>
    <head>
	<script src="node_modules/file-saver/FileSaver.min.js"></script>
    </head>

    <body>
	<form ref='uploadForm' 
	      id='uploadForm' 
	      action='http://localhost:3000/import' 
	      method='post'
	      target="_blank";
	      encType="multipart/form-data">
            <input type="file" name="convertFile" />
            <input type='submit' value='Convert!' />
	</form>
	<button onClick="convert()">Convert</button>
	<br>
	<br>
	<form ref='uploadForm' 
	      id='uploadForm' 
	      action='http://localhost:3000/upload' 
	      method='post'
	      target="_blank";
	      encType="multipart/form-data">
            <input type="file" name="uploadFile" />
            <input type='submit' value='Upload!' />
	</form>
    </body>

    <script>
     
     function convert() {
	 var type = "pdf";
	 var url = "http://localhost:3000/export/" + type;
	 var str = "# Some text\nthat contains this stuff and *maybe* some more  things...\n*first\n*second\n## Basic\n markdown is nice.";
	 var data = { markdown: str};
	 var xhr = new XMLHttpRequest();
	 xhr.open("POST", url, true);
	 xhr.responseType = "blob";
	 xhr.setRequestHeader("Content-type", "application/json");
	 xhr.send(JSON.stringify(data));

	 xhr.onreadystatechange = function() {
	     if (xhr.readyState === 4) {
		 let file = xhr.response; //Outputs a DOMString by default
		 saveAs(file, "convert." + type);	 
	     }
	 }
	 
     }


     
    </script>

    
</html>
